<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Workflow Process</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link href="../assets/css/style.css" rel="stylesheet">
    <link href="../assets/css/workflow-process.css" rel="stylesheet">
    
    <!-- Alpine.js -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.13.3/dist/cdn.min.js"></script>
</head>
<body x-data="workflowProcessApp()" x-init="init()">
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg sticky-top">
        <div class="container">
            <div class="w-100 d-flex justify-content-between align-items-center">
                <a class="navbar-brand" href="../index.html" style="text-decoration: none;">
                    Workflow Process
                </a>
                <a href="../index.html" class="btn btn-outline-primary btn-sm">
                    ← Back to Workflows
                </a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <!-- Workflow Header -->
            <div class="workflow-header mb-4">
                <div class="row align-items-center">
                    <div class="col-12">
                        <h1 class="workflow-title" x-text="workflow.name"></h1>
                        <p class="workflow-description text-muted" x-text="workflow.description"></p>
                    </div>
                </div>
            </div>

            <!-- Progress Tracker -->
            <div class="progress-tracker mb-5">
                <div class="progress-header mb-3">
                    <h3>How Agents Work Together</h3>
                    <p class="text-muted">Track the execution flow of your workflow agents</p>
                </div>
                
                <!-- No Agents Available Message -->
                <div x-show="!loading && workflow.agents.length === 0" class="no-agents-message text-center py-5">
                    <div class="alert alert-info border-0" style="background-color: #f8f9fa;">
                        <div class="mb-3">
                            <i class="bi bi-info-circle-fill text-danger" style="font-size: 2rem;"></i>
                        </div>
                        <h5 class="text-danger mb-2">Not Found</h5>
                        <p class="text-muted mb-0">
                            Please check the workflow configuration. 
                            
                        </p>
                    </div>
                </div>
                
                <!-- Agents Timeline (only show if agents exist) -->
                <div x-show="workflow.agents.length > 0" class="progress-timeline">
                    <template x-for="(agent, index) in workflow.agents" :key="agent.agent_name">
                        <div class="progress-step" :class="{ 'completed': index < currentStep, 'active': index === currentStep }">
                            <div class="step-indicator">
                                <span class="step-number" x-text="index + 1"></span>
                            </div>
                            <div class="step-content">
                                <h5 class="step-title" x-text="agent.agent_display_name"></h5>
                                <p class="step-description" x-text="agent.agent_description"></p>
                            </div>
                        </div>
                    </template>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="action-buttons mt-5 mb-4">
                <div class="row justify-content-center">
                    <div class="col-md-8 text-center">
                        <button 
                            class="btn btn-lg me-3" 
                            :class="workflow.agents.length > 0 ? 'btn-primary' : 'btn-light'"
                            :disabled="workflow.agents.length === 0"
                            :style="workflow.agents.length === 0 ? 'background-color: #e9ecef; border-color: #dee2e6; color: #6c757d; cursor: not-allowed;' : ''"
                            :title="workflow.agents.length === 0 ? 'No agents available to manage prompts' : ''"
                            @click="managePrompts()">
                            <i class="bi bi-file-text"></i> Manage Prompts
                        </button>
                        <button 
                            class="btn btn-lg" 
                            :class="workflow.agents.length > 0 ? 'btn-success' : 'btn-light'"
                            :disabled="workflow.agents.length === 0"
                            :style="workflow.agents.length === 0 ? 'background-color: #e9ecef; border-color: #dee2e6; color: #6c757d; cursor: not-allowed;' : ''"
                            :title="workflow.agents.length === 0 ? 'No agents available to run evaluation' : ''"
                            @click="runEvaluation()">
                            <i class="bi bi-play-fill"></i> Run Evaluation
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer mt-auto">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-md-8 text-center">
                    <div class="text-muted small">
                        <div class="mb-1">
                            <strong><span id="currentYear"></span> Insight Services APAC®</strong>
                        </div>
                        <div>
                            Powered by AI workflows and intelligent automation.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom JavaScript -->
    <script src="../assets/js/workflow-process.js"></script>
    
    <!-- Set current year in footer -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const yearElement = document.getElementById('currentYear');
            if (yearElement) {
                yearElement.textContent = new Date().getFullYear();
            }
        });
    </script>
</body>
</html>
